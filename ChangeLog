2009-11-06  Richard Dale  <richard.j.dale@gmail.com>

* The binding for virtual method callbacks for the QtNetwork module wasn't
being initialized correctly
* When a C++ type was being marhalled to a QtScript value and wrapped, the
smoke library for the class of the item was being set to the smoke module of
the method being called, rather than the smoke module of the item itself.
* Added some more examples.

2009-11-05  Richard Dale  <richard.j.dale@gmail.com>

* Rename virtual method callbacks which are also properties, such as sizeHint()
and call them getSizeHint() etc instead.
* Added the CalendarWidget.qs example
* Added QVariant.valueOf() which converts a QVariant to the value it contains.
At the moment this is wrongly called for all Smoke classes, and not just
QVariant though, and so there is a but to be fixed in setting up the prototype
chain.
* Added QVariant.fromValue() to create a QVariant from types such as QColor
which don't have a constructors.
* Fixed bug in marshalling JavaScript dates to Qt C++ date types
* Create a prototype instance for the MetaData QScriptClass classes.
* Added the CollidingMice.qs example

2009-11-02  Richard Dale  <richard.j.dale@gmail.com>

* Setting QObject properties now works correctly. The initial approach of using
QScriptClass::setProperty() didn't work for classes which were subclassed.
Instead SmokeQObject::propertyFlags() returns QScriptValue::PropertyGetter and 
QScriptValue::PropertySettergetter for QObject properties, then getter and
setter functions are returned by SmokeQObject::property().
* Fixed bug when calling methods as the smoke module corresponding to the
instance was being passed, and not the smoke module corresponding to the method
call.
* When resolving overloaded methods with enum arguments, make 'uint' types the
second most important after an actual match on the enum type itself.
* Added support for the HasInstance extension so that 'instanceof' now works 
correctly with the smoke classes. For instance:

    print(dialog instanceof MyWidget); // returns true
    print(dialog instanceof QWidget); // returns true
    print(dialog instanceof Object); // returns true

Will all return true when MyWidget is a subclass of QWidget
* When the full signature of a signal is specified, such as 'activated(int)' 
is it used to find a match.
* Added the BasicDrawing.qs example, which runs fine, but doesn't yet draw 
anything.

2009-10-30  Richard Dale  <richard.j.dale@gmail.com>

* Added support for nested classes such as QPainterPath::Element
* Implemented the Qt.Debug.Calls option to trace method calls
* The Qt.Debug.Ambiguous trace option has been rename Qt.Debug.MethodMatches
* Added a default toString() method which show instances like this in the method
call tracing:

Trace: QPen.QPen([object QBrush:0x08ec3ef0], 1, 1, 0, 0) => [object QPen:0x08ecab58]

* Added some missing QList and QVector marshallers for nested classes

2009-10-29  Richard Dale  <richard.j.dale@gmail.com>

* Added various sort of debug tracing that can be turned on from scripts by
setting the Qt.Debug.trace property. For example:

    Qt.Debug.trace = Qt.Debug.Properties | Qt.Debug.GC;
    var path = QDir.currentPath();
    Qt.Debug.trace = Qt.Debug.None;

Will turn on property and garbage collection tracing before method call, and 
setting the trace property to 'Qt.Debug.None' turns everything off. The options
can be combined by or'ing them together. Possible values are:

    Qt.Debug.None
    Qt.Debug.Ambiguous
    Qt.Debug.Properties
    Qt.Debug.Calls
    Qt.Debug.GC
    Qt.Debug.Virtual

2009-10-28  Richard Dale  <richard.j.dale@gmail.com>

* Use individual smoke libraries for qtcore, qtgui and qtnetwork instead of the
single qt smoke file with everything. The next thing to do is to split up the 
project into individual qtscript plugins for each smoke library.
* A javascript regular expression can be provided as an argument everywhere a
QRegExp is expected.

2009-10-27  Richard Dale  <richard.j.dale@gmail.com>

* Enums are now marshalled to and from Qt.Enum instances. The Qt.Enum has
'value' and 'type' properties. The 'type' property allows the name of the enum
type to be used for resolving methods overloaded on the enum types of their 
arguments.
* If there is a C++ toString() method use that instead of the built-in 
JavaScript one.

2009-10-26  Richard Dale  <richard.j.dale@gmail.com>

* Fixed bug when methods were being looked up in the 'QGlobalSpace' global
space.
* Added the DigitalClock example

2009-10-25  Richard Dale  <richard.j.dale@gmail.com>

* Added reading QObject properties. Setting QObject properties still doesn't 
work.

2009-10-16  Richard Dale  <richard.j.dale@gmail.com>

* Added a QScriptClass called QtScriptSmoke::SmokeQObject to handle QObjects,
and intercept access to signals, QObject set and get properties. Instances of
QObjects are held in QtScriptSmoke::SmokeQObject::Instance, which has a 
QScriptValue created with newQObject(), containing the QObject C++ instance.

2009-10-15  Richard Dale  <richard.j.dale@gmail.com>

* Improved the debugging logging for querying properties
* Added the Wiggly.qs example
* Rename Debug::Property as Debug::Properties

2009-10-14  Richard Dale  <richard.j.dale@gmail.com>

* Changed QScriptSmoke::Instance to be nested within QScriptSmoke::Object
* Fixed bugs in constructCopy() and it now works
* Attempted to return a signal handler when a signal name property was 
referenced by wrapping a Smoke QObject instance with 
QScriptEngine::newQObject(), and then obtaining the property from it. However,
although there are no runtime errors the target slot is never called.
* It seems the above problem is caused by only one of these two syntaxes work;

    timer.timeout.connect(this, "update()");   // Doesn't work
    timer.timeout.connect(this, this.update);  // Works

And in fact QtScript style connect() call do actually work. At the moment 
everytime a method is called on a QObject, it checks whether or not it is a
signal by looking in the QMetaObject. Maybe it would be better to find all the
signal names when a QObject is first instantiated and add all the signal 
functions as properties. Rather than just QtScriptSmoke::Object, there should
a QtScriptSmoke::QObject class as well, that held its QObject instance wrapped
with a engine->newQObject() call in a nested QObject::Instance class.

2009-10-13  Richard Dale  <richard.j.dale@gmail.com>

* Added a convenience method for wrapping an existing C++ instance, 
Global::wrapInstance() and wrapped 'qApp' as a global object property with it.

2009-10-12  Richard Dale  <richard.j.dale@gmail.com>

* Added more marshallers
* Amend the AnalogClock example to use SLOT() and SIGNAL() functions so that it
works for now, until the more QtScript-like slot/signal handling is implemented.

2009-10-11  Richard Dale  <richard.j.dale@gmail.com>

* Added a DEF_CONTAINER_MARSHALLER macro and defined a lot of QList and QVector
types to be marshalled

2009-10-10  Richard Dale  <richard.j.dale@gmail.com>

* The AnalogClock.qs example nearly works! Remaining problems are slots/signals
not being implemented, and 'this.height' not working as it needs to be 
'this.height()'. It isn't obvious how function calls and attribute accesses 
should be distinguished in QScriptClass in order to fix the attribute problem.
For signals/slots it might be possible to reuse the existing implementation,
but it seem that it expects instances to be embedded inside QVariants and 
wouldn't work with a QScriptSmoke::Instance embedded inside a QVariant.
* Fixed class loading problem where the Qt class and associated enums wasn't
being loaded at startup
* Improved overloaded method resolution so that it takes into account instances
of a class being the same or subclasses
* Moved all the type registration code into handlers.cpp

2009-10-09  Richard Dale  <richard.j.dale@gmail.com>

* Improve error messages over 'seg fault' when a method isn't found in the 
Smoke lib, or an overloaded method isn't resolved
* Allow a QtScript Date to be passed for any QDate, QDateTime or QDate arg
* Load all the classes from a Smoke lib at startup, as all the 'include()'
statements make the scripts look a bit clunky IMHO. But we should compare the
time and memory used to make sure it isn't a problem.
* Add an optional arguement to allow a script name to be given so that more 
than just '../test.qs' can be run. Create a test subdirectory for test scripts.
* Added some debug logging for accessing the C++ pointer to QScriptValue map
* Added a qScriptSmokeRegisterSequenceMetaType() function based on 
qScriptRegisterSequenceMetaType() but using marshaller and demarshaller 
functions that work with QScriptValues wrapped as smoke instances.
* Added a test marshaller for QVector<QPoint> to try the sequence marshaller,
and it does seem to do something useful. Where the metatypes should be declared
and so on needs more thought though.

2009-10-08  Richard Dale  <richard.j.dale@gmail.com>

* Virtual method overrides are now working. Added propertyFlags() methods to
QtScriptSmoke::MetaObject and Object classes that returns 
QScriptValue::ReadOnly. This makes it possible to distiguish between custom
qtscript functions and built in smoke methods.
* If an enum, such as QPainter.Antialiasing, is referenced, then return the
value directly, rather than returning a function to be evaluated.
* Once an argument type that can't be marshalled has been found, abandon the 
method call and throw an exception
* If an argument type has 'QList' or 'QVector' in it, assume it will match a
QtScript Array

2009-10-07  Richard Dale  <richard.j.dale@gmail.com>

* Argument and return types that can't be handled are no longer fatal, but are
QScript TypeError exceptions instead
* Add a singleton QtScriptSmoke::Global::Object which is the QScriptClass of 
Smoke instances
* Don't change the 'thisObject' in the MethodCall when a new instance has been
constructed, but assume a correct one has been set up in the context before, and
passed to the MethodCall. This is to allow constructors to be called for 
subclasses of the classes in the Smoke library.
* Attempt to allow subclassing by implementing the call() method to trap calls
like 'QWidget(this, parent);' in constructor functions. Not sure if it is 
really working, but it is a start.

2009-10-06  Richard Dale  <richard.j.dale@gmail.com>

* Added a QtScriptSmoke::constructCopy() method for when a C++ instance being
marshalled needs to be copied
* Add a m_classId instance variable to the QtScriptSmoke::MetaObject class
* Use the same trick of storing the name of a function in the data() of a 
Function object for static method calls as for instance method calls. Add a
classId() accessor method to the QtScriptSmoke::MetaObject class so that the
classId for a static method call can be obtained from the thisObject() by the
new callSmokeStaticMethod() function.

2009-10-05  Richard Dale  <richard.j.dale@gmail.com>

* Fixed off by one error in the virtual method override argument marshalling
* Unconditionally return false from QtScriptSmokeBinding::callMethod() until we
fix subclassing and the test for whether a virtual method has been overriden
* Use 'QtScriptSmoke' as a namespace as it's the name of the project, and 
rename the QtScriptSmoke class as RunQtScriptSmoke.
* Added QtScriptSmoke::resolveMethod() to resolve the QtScript function call
with methods in the Smoke lib matching the name and argument types.
* Change the QtScript:: namespace to QtScriptSmoke:: and put everything in that
* Rename StaticClass as QtScriptSmoke::MetaObject and ImplementationClass as 
QtScriptSmoke::Object
* Rename the StaticClass.h and .cpp files as metaobject.h and .cpp, and the 
ImplementationClass.h and .cpp as object.h and .cpp

2009-10-04  Richard Dale  <richard.j.dale@gmail.com>

* The marshalling of C++ instances to QScriptValues is now working. It is
possible to obtain a QSize instance via dialog.size() in the example script
and then call width() on the returned QSize.
* The Marshall::var() method now returns a 'QScriptValue *' rather than a value.

2009-10-03  Richard Dale  <richard.j.dale@gmail.com>

* Method calls are now working via QtScript::MethodCall and the Smoke 
marshalling framework is working. So the basics are looking pretty good, just
the overloaded method resolution code needs finishing
* The virtual method overriding code is quite close to working, and we just 
need a way to determine if a method has been overloaded in QtScript, which is
probably obvious, but needs investigating.

2009-10-02  Richard Dale  <richard.j.dale@gmail.com>

* Added code to call an overriden virtual method. Not working yet, not sure how
to tell if the method has been overriden or not.
* Added some debugging enum values to control debugging areas, and switch 
debugging on
* Unmap the pointer for a C++ instance which has been deleted
 
2009-09-29  Richard Dale  <richard.j.dale@gmail.com>

* Added a global hash to map C++ pointers onto the corresponding QScriptValues

2009-09-28  Richard Dale  <richard.j.dale@gmail.com>

* Added some more marshallers, now complete all primitve types and strings.
* Timed startup with creating 500 'StaticClass' classes, and found the time
taken to be negligable. Left the code in qtscript-smoke.cpp commented out, so
that Ian can try.

2009-09-27  Richard Dale  <richard.j.dale@gmail.com>

* Add virtual method call marshallers
* Began some implementation of the marshalling code for QScript to the Smoke
stack

2009-09-24  Richard Dale  <richard.j.dale@gmail.com>

* Added a marshalling framework based on the PerlQt design. It doesn't work
yet though.
* Added a ChangeLog to the project, now it seems to be a bit more than a 
prototype